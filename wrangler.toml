name = "twitter-loyalty-bot"
main = "src/index.js"
compatibility_date = "2024-11-23"
compatibility_flags = ["nodejs_compat"]

# Custom domain configuration
[[routes]]
pattern = "x-demo.loyalteez.app/*"
zone_name = "loyalteez.app"

# Service bindings for worker-to-worker communication
[[services]]
binding = "EVENT_HANDLER"
service = "loyalteez-event-handler"

# KV for tracking tweet processing to avoid duplicates
[[kv_namespaces]]
binding = "TWITTER_BOT_KV"
id = "2ccf358b408844289785f1ff3e272bf1"

# Scheduled trigger for polling (every 15 mins)
[triggers]
crons = ["*/15 * * * *"]

[vars]
# Loyalteez Brand ID (Wallet Address)
BRAND_ID = "0xf8964eB6D654659a4935363595db1095474Be22F"
# API URL
LOYALTEEZ_API_URL = "https://api.loyalteez.app"
# Supabase connection (reads Twitter handle from Partner Portal config)
SUPABASE_URL = "https://lrvnppgnngnkstouozzk.supabase.co"

# ============================================
# SECRETS - Set via Cloudflare Dashboard or CLI
# wrangler secret put TWITTER_BEARER_TOKEN
# wrangler secret put SUPABASE_ANON_KEY
# ============================================
